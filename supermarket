package com.example.demo1;

import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.*;
import javafx.stage.Stage;
import java.time.LocalDate;
import java.util.Random;

public class SuperMarketBilling extends Application {

    TextField tfName, tfPrice, tfQty, tfCustomer, tfDiscount;
    TextArea billArea;
    double total = 0;
    int billNo;

    @Override
    public void start(Stage stage) {

        billNo = new Random().nextInt(10000);

        Label title = new Label("SUPER MARKET BILLING SYSTEM");
        title.setStyle("-fx-font-size: 18px; -fx-font-weight: bold;");

        tfCustomer = new TextField();
        tfCustomer.setPromptText("Customer Name");

        tfName = new TextField();
        tfName.setPromptText("Product Name");

        tfPrice = new TextField();
        tfPrice.setPromptText("Price");

        tfQty = new TextField();
        tfQty.setPromptText("Quantity");

        tfDiscount = new TextField();
        tfDiscount.setPromptText("Discount %");

        Button addBtn = new Button("Add Item");
        Button billBtn = new Button("Generate Bill");
        Button clearBtn = new Button("Clear");
        Button exitBtn = new Button("Exit");

        billArea = new TextArea();
        billArea.setPrefHeight(250);
        billArea.setEditable(false);
        billArea.setText("Item\tQty\tPrice\n");

        addBtn.setOnAction(e -> addItem());
        billBtn.setOnAction(e -> generateBill());
        clearBtn.setOnAction(e -> clearAll());
        exitBtn.setOnAction(e -> stage.close());

        GridPane grid = new GridPane();
        grid.setVgap(8);
        grid.setHgap(8);

        grid.add(new Label("Customer:"), 0, 0);
        grid.add(tfCustomer, 1, 0);

        grid.add(new Label("Product:"), 0, 1);
        grid.add(tfName, 1, 1);

        grid.add(new Label("Price:"), 0, 2);
        grid.add(tfPrice, 1, 2);

        grid.add(new Label("Quantity:"), 0, 3);
        grid.add(tfQty, 1, 3);

        grid.add(new Label("Discount %:"), 0, 4);
        grid.add(tfDiscount, 1, 4);

        HBox buttons = new HBox(10, addBtn, billBtn, clearBtn, exitBtn);

        VBox root = new VBox(10, title, grid, buttons, billArea);
        BackgroundImage bg = new BackgroundImage(
                new javafx.scene.image.Image(
                        getClass().getResource("/bg.jpg").toExternalForm()
                ),
                BackgroundRepeat.NO_REPEAT,
                BackgroundRepeat.NO_REPEAT,
                BackgroundPosition.CENTER,
                new BackgroundSize(
                        BackgroundSize.AUTO,
                        BackgroundSize.AUTO,
                        false,
                        false,
                        true,
                        true
                )
        );

        root.setBackground(new Background(bg));

        root.setStyle("-fx-padding: 15;");

        stage.setScene(new Scene(root, 520, 520));
        stage.setTitle("Billing System");
        stage.show();
    }

    void addItem() {

        if (tfName.getText().isEmpty() ||
                tfPrice.getText().isEmpty() ||
                tfQty.getText().isEmpty()) {

            billArea.appendText("❌ Enter all item details!\n");
            return;
        }

        String name = tfName.getText();
        double price = Double.parseDouble(tfPrice.getText());
        int qty = Integer.parseInt(tfQty.getText());

        double itemTotal = price * qty;
        total += itemTotal;

        billArea.appendText(name + "\t" + qty + "\t" + itemTotal + "\n");

        tfName.clear();
        tfPrice.clear();
        tfQty.clear();
    }

    void generateBill() {

        if (total == 0) {
            billArea.appendText("\n❌ No items added!\n");
            return;
        }

        double gst = total * 0.05;

        double discountPercent = 0;
        if (!tfDiscount.getText().isEmpty()) {
            discountPercent = Double.parseDouble(tfDiscount.getText());
        }

        double discount = total * discountPercent / 100;
        double finalAmount = total + gst - discount;

        billArea.appendText("\n----------------------------\n");
        billArea.appendText("Bill No: " + billNo + "\n");
        billArea.appendText("Date: " + LocalDate.now() + "\n");
        billArea.appendText("Customer: " + tfCustomer.getText() + "\n");
        billArea.appendText("Total: " + total + "\n");
        billArea.appendText("GST (5%): " + gst + "\n");
        billArea.appendText("Discount: -" + discount + "\n");
        billArea.appendText("Final Amount: " + finalAmount + "\n");
    }

    void clearAll() {
        total = 0;
        billArea.setText("Item\tQty\tPrice\n");
        tfCustomer.clear();
        tfDiscount.clear();
    }

    public static void main(String[] args) {
        launch(args);
    }
}
